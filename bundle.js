(()=>{"use strict";class e{forms={page1:"page1Form",page2:"page2Form",page3:"page3Form"};constructor(){this.init()}init(){document.querySelectorAll(`#${this.forms.page1} [required]`).forEach((e=>{this.addValidator(e.id,this.forms.page1)})),document.querySelectorAll(`#${this.forms.page2} [required]`).forEach((e=>{this.addValidator(e.id,this.forms.page2)})),document.getElementsByName("drives_car").forEach((e=>{e.addEventListener("input",(e=>{const t=document.getElementById("experience");"drive"===e.target.id?(t.required=!0,this.addValidator("experience",this.forms.page3),document.getElementById("drivingExperienceSection").hidden=!1,t.focus()):(t.required=!1,t.value=null,this.removeValidator("experience"),document.getElementById("drivingExperienceSection").hidden=!0),this.checkFormValidity(this.forms.page3)}))}))}addValidator(e,t){document.getElementById(e).addEventListener("input",(()=>this.validateRequiredInputs(e,t)))}removeValidator(e){removeEventListener("input",document.getElementById(e))}validateRequiredInputs(e,t){const i=document.getElementById(e);i.value&&""!==i.value.trim()?document.getElementById(`${e}Error`).hidden=!0:document.getElementById(`${e}Error`).hidden=!1,this.checkFormValidity(t)}checkFormValidity(e){const t=document.getElementById(e).checkValidity(),i=document.querySelector(`#${e} .next-button`);t?(i.disabled=!1,i.classList.remove("opacity-50","cursor-not-allowed")):(i.disabled=!0,i.classList.add("opacity-50","cursor-not-allowed"))}}new class{state={};validators=null;constructor(t,i={}){this.container=document.getElementById(t),this.pages=Array.from(this.container.getElementsByClassName("page")),this.currentPage=i.page||1,this.state=i,this.hideAllPages(),this.showPage(this.currentPage),this.setupNavigation(),this.loadCountriesList(),this.validators=new e}async loadCountriesList(){const e=await this.getCountries(),t=document.getElementById("country");e.forEach((e=>{const i=document.createElement("option");i.value=e.Iso3,i.textContent=e.name,t.appendChild(i)})),document.getElementById("page1NextButton").hidden=!1}async getCountries(){try{const e=await fetch("https://countriesnow.space/api/v0.1/countries/iso");if(!e.ok)throw new Error(await e.text());return(await e.json()).data}catch(e){return console.error(e),[]}}hideAllPages(){this.pages.forEach((e=>{e.hidden=!0})),document.getElementById("formSubmitted").hidden=!0}showPage(e){const t=e-1;t<0||t>=this.pages.length||(this.hideAllPages(),this.pages[t].hidden=!1,this.currentPage=e,this.updatePageState())}setupNavigation(){document.querySelectorAll(".back-button").forEach((e=>{e.addEventListener("click",(()=>{this.showPage(this.currentPage-1)}))})),document.querySelectorAll(".next-button").forEach((e=>{e.addEventListener("click",(()=>{this.updateState(),"submitButton"===e.id?(document.getElementById("page3").hidden=!0,document.getElementById("formSubmitted").hidden=!1,document.getElementById("collectedJSON").innerText=JSON.stringify(this.state,null,4)):this.showPage(this.currentPage+1)}))})),document.getElementById("resetButton").addEventListener("click",(()=>this.restart()))}updateState(){document.querySelectorAll(`#page${this.currentPage}Form [required], #page${this.currentPage}Form input[type="radio"]`).forEach((e=>{if(this.state[e.name]=e.value,2===this.currentPage){this.state.has_children=!0===this.state.has_children||"true"===this.state.has_children;const e=document.querySelectorAll("#hobbies option:checked");this.state.hobbies=Array.from(e).map((e=>e.value))}else if(3===this.currentPage){const e=document.querySelector('[name="drives_car"]:checked').value;this.state.drives_car="true"===e,this.state.experience=parseInt(this.state.experience,10)||null}}))}updatePageState(){this.state.page=this.currentPage,console.log(this.state)}restart(){this.state={},document.getElementById("drivingExperienceSection").hidden=!0,document.getElementById("collectedJSON").innerText="",document.querySelectorAll("form").forEach((e=>{e.reset(),this.validators.checkFormValidity(e.id)})),this.showPage(1)}}("wizard",{page:1})})();